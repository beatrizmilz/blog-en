---
title: "Introdu√ß√£o ao GitHub Actions para quem programa em R"
subtitle: "S√©rie GitHub Actions - 1 - Neste post, apresentarei brevemente o GitHub Actions e mostrarei como voc√™ pode come√ßar a usar o GitHub Actions com R."
author: "Beatriz Milz"
date: "2022-06-30"
categories: ["Git", "GitHub", "GitHub Actions", "Automations"]
image: "featured.png"
toc: true
draft: false
---

```{r multilang-buttons}
#| results: asis
#| echo: false
source(here::here("R/multilang.R"))
multilang()
```

Oi!
Este √© o primeiro post da s√©rie "GitHub Actions".
Esta s√©rie de posts √© um material complementar para minha palestra rel√¢mpago na [RStudio Conference - rstudio::conf 2022](https://www.rstudio.com/conference/).

[![](images/talk.png){fig-align="center" width="70%"}](https://rstudioconf2022.sched.com/event/11ia9?iframe=no)

Neste post, **apresentarei brevemente o GitHub Actions e mostrarei como voc√™ pode come√ßar a usar o GitHub Actions com R**.

## O que √© GitHub Actions?

[GitHub Actions](https://github.com/features/actions) √© um recurso do [GitHub](https://github.com/) que nos permite automatizar tarefas com c√≥digo.
Por exemplo, podemos especificar uma s√©rie de comandos a serem executados quando √© ativado!

Podemos fazer muitas automa√ß√µes diferentes com o GitHub Actions, como:

-   Baixar e salvar um arquivo todos os dias (como `.csv`/`.xlsx`/`.json` ..);

-   Executar um script em R e salvar os resultados em um banco de dados, ou uma Planilha do Google, por exemplo;

-   Execu√ß√£o de rotinas de web scraping;

-   Renderiza√ß√£o de um documento RMarkdown ou Quarto;

-   E assim por diante!
    üöÄ

## Como usar o GHA em um pacote em R?

O GitHub Actions √© muito usado no desenvolvimento de pacotes para CI/CD.
Por exemplo, pessoas que desenvolvem pacotes usam GitHub Actions para realizar testes em seu c√≥digo, executar rotinas de checagem, atualizar a documenta√ß√£o e o site do pacote, entre outras coisas.

::: callout-tip
## O que √© CI/CD no contexto de pacotes em R?

A integra√ß√£o cont√≠nua (Continuous integration - CI) √© uma pr√°tica de desenvolvimento que exige que as pessoas que desenvolvem o pacote integrem regularmente o c√≥digo no reposit√≥rio, ap√≥s o qual verifica√ß√µes e testes automatizados s√£o executados para verificar a integridade do novo c√≥digo.

A entrega cont√≠nua (Continuous delivery - CD) √© uma metodologia de desenvolvimento de software na qual as altera√ß√µes de c√≥digo s√£o verificadas, testadas e liberadas para produ√ß√£o automaticamente.
**Isso permite que novas vers√µes de pacotes sejam lan√ßadas com frequ√™ncia.**
:::

O pacote [usethis](https://usethis.r-lib.org/reference/github_actions.html) nos ajuda a configurar GitHub Actions em pacotes R.
√â essencial saber que, por padr√£o, as Actions criadas usando usethis v√™m do [reposit√≥rio r-lib/actions](https://github.com/r-lib/actions/tree/v2-branch/examples#readme).
Salve este link; o conte√∫do √© muito relevante!

::: callout-note
## üèÜ

Gostaria de agradecer todo o trabalho feito por quem [contribui com o reposit√≥rio r-lib/actions](https://github.com/r-lib/actions/graphs/contributors).
üèÜ Este reposit√≥rio foi a fonte mais importante de conte√∫do e c√≥digo sobre GitHub Actions para R para mim.

[![](images/actions-repo.png){fig-align="center" width="100%"}](https://github.com/r-lib/actions/blob/v2-branch/examples/README.md)
:::

Aqui est√£o alguns exemplos de como configurar GH Actions em pacotes:

-   Para realizar checagens (como `devtools::check()` ) em um pacote sempre que houver uma altera√ß√£o no c√≥digo, use:

```{r}
#| eval: false
usethis::use_github_action("check-release")
```

Isso √© √∫til porque toda vez que ocorre um erro no check, recebemos um e-mail do GitHub ‚ö†Ô∏è.
Assim, sabemos que algo est√° quebrando o c√≥digo e podemos corrigi-lo o mais r√°pido poss√≠vel.

-   Para atualizar o site do pacote (como `pkgdown::build_site()`) toda vez que houver uma mudan√ßa no c√≥digo, use:

```{r}
#| eval: false
usethis::use_github_action("pkgdown")
```

Isso permite que o site e a documenta√ß√£o do pacote estejam sempre atualizados.
üìå

## Como usar o GHA em um script em R?

J√° sabemos que podemos fazer automa√ß√µes muito legals em pacotes em R usando GitHub Actions.
Mas a maioria das pessoas que programam em R que conhe√ßo usam scripts R e arquivos RMarkdown no dia-a-dia.
N√£o encontrei exemplos de uso do GHA com scripts simples (sem a estrutura do pacote) no [reposit√≥rio r-lib/actions](https://github.com/r-lib/actions/blob/v2-branch/examples/%20README.md).
Ent√£o, para isso, precisamos conhecer como funciona o GHA!

A [documenta√ß√£o do GitHub sobre fluxos de trabalho (workflows)](https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions) √© uma excelente fonte para saber mais sobre esse t√≥pico.

Primeiro, a automatiza√ß√£o feita com GHA √© chamada de **Workflow** (ou fluxo de trabalho em portugu√™s).
O fluxo de trabalho tem duas partes principais: **Events** (eventos) e **Jobs** (trabalhos).

-   **Events/Eventos** descrevem o que pode iniciar um fluxo de trabalho.
    Por exemplo, um evento pode ser "iniciar este fluxo de trabalho todos os dias √†s 9h" ou "toda vez que algu√©m fizer um push no reposit√≥rio" (em outras palavras, quando h√° alguma altera√ß√£o no c√≥digo).

-   **Jobs/Trabalhos** descreve o que o computador deve fazer.
    Imagine que ele come√ßa sem nenhum software instalado!
    Portanto, precisamos dizer qual Sistema Operacional (SO) queremos que nosso c√≥digo execute (por exemplo, Ubuntu / Windows / Mac OS).
    Al√©m disso, precisamos instalar o R e quaisquer pacotes necess√°rios para executar o nosso c√≥digo.
    Depois disso, podemos adicionar o script que queremos executar em R e salvar os resultados gerados.

## Exemplo

Aqui est√° um exemplo de um arquivo de fluxo de trabalho simples.
O fluxo de trabalho inicia ao pressionar um bot√£o no GitHub (o evento).
Ele instala o R e imprime a mensagem "Hello R World!" no console (o trabalho).

``` yml
# Evento/Event - O que inicia o fluxo de trabalho/workflow?
on:
  workflow_dispatch:

# Nome do workflow
name: hello-r-world

# Trabalho/Jobs - O que o computador deve fazer?
jobs:
  write-message:
    # Vamos usar o Ubuntu  
    runs-on: ubuntu-latest 
    steps:
       # Instalar o R
      - uses: r-lib/actions/setup-r@v3    
      - name: print-message   
        # C√≥digo para executar um comando em R
        run: Rscript -e 'print("Hello R World!")' 
```

## Vejo voc√™ no pr√≥ximo post!

Essa √© a ideia geral do GitHub Actions.
No pr√≥ximo post, escreverei como voc√™ pode criar um GHA que execute um script R e salve o resultado no reposit√≥rio do GitHub.
Acompanhe!

## Agradecimentos

-   [Daniel Falbel](https://github.com/dfalbel), [Athos Damiani](https://github.com/Athospd) e [Julio Trecenti](https://github.com/jtrecenti): as pessoas que me apresentaram ao GitHub Actions, responderam perguntas e enviaram v√°rios links incr√≠veis.Obrigada!

-   As pessoas que contribuem com o [reposit√≥rio r-lib/actions](https://github.com/r-lib/actions/graphs/contributors): üèÜ Este reposit√≥rio foi a fonte mais significativa de conte√∫do sobre GitHub Actions for R para mim.

-   [Julio Trecenti](https://github.com/jtrecenti): obrigada por revisar o post!

## Refer√™ncias

-   [GitHub Actions](https://github.com/features/actions)

-   [Pacote usethis](https://usethis.r-lib.org/reference/github_actions.html)

-   [Reposit√≥rio r-lib/actions](https://github.com/r-lib/actions/tree/v2-branch/examples#readme)

-   [Documenta√ß√£o do GitHub sobre workflows](https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions)

## Compartilhe e apoie!

Se voc√™ gosta desse tipo de conte√∫do, considere me apoiar no [GitHub Sponsors](https://github.com/sponsors/beatrizmilz/) ou compartilhar o conte√∫do no Twitter:

<center>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">I wrote a new blog post about &quot;Introduction to GitHub Actions to R users&quot;!<a href="https://t.co/lCBH4vIGa2">https://t.co/lCBH4vIGa2</a><br><br>This post is complementary material for my lightning talk at the <a href="https://twitter.com/rstudio?ref_src=twsrc%5Etfw">@rstudio</a> conference!<br><br>Feedback is always welcome :)<a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a> <a href="https://twitter.com/hashtag/github?src=hash&amp;ref_src=twsrc%5Etfw">#github</a> <a href="https://twitter.com/hashtag/githubactions?src=hash&amp;ref_src=twsrc%5Etfw">#githubactions</a> <a href="https://twitter.com/hashtag/rstudioconf?src=hash&amp;ref_src=twsrc%5Etfw">#rstudioconf</a> <a href="https://twitter.com/hashtag/rstudioconf2022?src=hash&amp;ref_src=twsrc%5Etfw">#rstudioconf2022</a></p>&mdash; Beatriz Milz (@BeaMilz) <a href="https://twitter.com/BeaMilz/status/1542526491807797248?ref_src=twsrc%5Etfw">June 30, 2022</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</center>

